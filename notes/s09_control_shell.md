#### 控制脚本

1. 处理信号

	> Linux利用信号与运行在系统中的进程进行通信。可以通过对脚本进行编程，使其在收到特定信号时执行 某些命令，从而控制shell脚本的操作。

	**Linux[*常见*]信号(signal)**

	| 信号   |   值    | 描述           |
	|:------|:--------|:-------------- |
	|  1    | SIGHUP  | 挂起进程        |
	|  2    | SIGINT  | 终止进程        |
	|  3    | SIGQUIT | 停止进程        |
	|  9    | SIGKILL | 无条件终止进程   |
	|  15   | SIGTERM | 尽可能终止进程   |
	|  17   | SIGSTOP | 无条件停止进程，但不是终止进程 |
	|  18   | SIGTSTP | 停止或暂停进程，但不终止进程   |
	|  19   | SIGCONT | 继续运行停止的进程|

	> 默认情况下，bash shell会忽略收到的任何SIGQUIT (3)和SIGTERM (15)信号(正因为这样， 交互式shell才不会被意外终止)。但是bash shell会处理收到的SIGHUP (1)和SIGINT (2)信号。

2. 后台运行脚本
	* 运行方式` ./xxx.sh &` # 在之前的运行方式的基础上，加一个`&`(*这种方式运行脚本，输出依然是打印到屏幕上面*)
	
	`./xxx.sh &> log.log &` # 将后台脚本输出到文件
	
	* **让脚本一直在后台运行，即使当前终端关闭**：
	```
	nohup ./xxx.sh &
	```
	
		该命令会把原本的`STDOUT`与`STDERR`的输出，不打印到屏幕，而是输出到`nohup.out`文本中(当前目录下)
	
	
3. 作业控制

	启动、停止、终止以及恢复作业的这些功能统称为作业控制。通过作业控制，就能完全控制 shell环境中所有进程的运行方式了。
	* 查看作业
	
	```
	jobs # 用于查看作业
	```
	
	jobs命令参数
	
	| 参数 | 描述 |
	| ---  | --- |
	| -l   | 列出进程的PID以及作业号 |
	| -n   | 只列出上次shell发出的通知后改变了状态的作业 |
	| -p   | 只列出作业的PID |
	| -r   | 只列出运行中的作业 |
	| -s   | 只列出已停止的作业 |
	
	* 调整作业的运行
	
		相关命令: `bg`,`fg`,`nice`,`renice`
	
	* 计划运行作业
	
		定时运行可用命令: `at`,`cron`
	
		`at`命令格式：
		```
		at [-f filename] time
		at -f abc.bash 11:30 PM
		```
	
	* `atq`命令可以查看系统中有哪些作业在等待
	* `atrm`命令用来删除作业，比如：`atrm 7` #**atrm后面的参数可用通过atq得到**
4. 安排需要定期执行的脚本
	* cron时间表
		cron时间表采用一种特别的格式来指定作业何时运行。其格式如下:
    `min hour dayofmonth month dayofweek command`
    `15 10 * * * command # 每天 10：15 执行命令`
    `15 16 * * 1 command # 每周一16：15 执行命令`
    
    > 可以用三字符的文本值(mon、tue、wed、thu、fri、sat、sun)或数值(0为周日，6为周六) 来指定dayofweek表项
    
    `00 12 1 * * command # 每月第一天中午 12:00 执行命令`
    ```
00 12 * * * if [`date +%d -d tomorrow` = 01 ] ; then ; command # 每月最后一天 12:00 执行命令```



















